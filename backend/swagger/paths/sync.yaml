# Sync Operations API Endpoints

/sync/prices:
  get:
    tags:
      - Sync
    summary: Get price sync data
    description: Retrieve current price data for synchronization with external systems
    responses:
      '200':
        description: Price data retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Price data retrieved successfully"
                data:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      sku:
                        type: string
                        example: "PROD-001"
                      name:
                        type: string
                        example: "Sample Product"
                      currentPrice:
                        type: number
                        format: float
                        example: 29.99
                      newPrice:
                        type: number
                        format: float
                        example: 32.99
                      currency:
                        type: string
                        example: "USD"
                      status:
                        type: string
                        enum: [pending, synced, failed]
                        example: "pending"
                      lastUpdated:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00Z"
      '500':
        $ref: '#/components/responses/InternalServerError'

  post:
    tags:
      - Sync
    summary: Sync prices to external systems
    description: Synchronize product prices with Magento and other external systems
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              products:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 1
                    sku:
                      type: string
                      example: "PROD-001"
                    price:
                      type: number
                      format: float
                      example: 32.99
              source:
                type: string
                enum: [magento, mdm, all]
                default: all
                description: Target system to sync to
              force:
                type: boolean
                default: false
                description: Force sync even if no changes detected
    responses:
      '200':
        description: Price sync completed successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Price sync completed successfully"
                data:
                  type: object
                  properties:
                    synced:
                      type: integer
                      example: 150
                    failed:
                      type: integer
                      example: 2
                    total:
                      type: integer
                      example: 152
                    request_items:
                      type: array
                      items:
                        type: object
                        properties:
                          sku:
                            type: string
                            example: "PROD-001"
                          status:
                            type: string
                            enum: [accepted, rejected, pending]
                            example: "accepted"
                          message:
                            type: string
                            example: "Price updated successfully"
      '400':
        $ref: '#/components/responses/BadRequest'
      '500':
        $ref: '#/components/responses/InternalServerError'

/sync/stocks:
  get:
    tags:
      - Sync
    summary: Get stock sync data
    description: Retrieve current stock data for synchronization
    responses:
      '200':
        description: Stock data retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      sku:
                        type: string
                        example: "PROD-001"
                      name:
                        type: string
                        example: "Sample Product"
                      currentStock:
                        type: integer
                        example: 100
                      newStock:
                        type: integer
                        example: 95
                      status:
                        type: string
                        enum: [pending, synced, failed]
                        example: "pending"
                      lastUpdated:
                        type: string
                        format: date-time
      '500':
        $ref: '#/components/responses/InternalServerError'

  post:
    tags:
      - Sync
    summary: Sync stock levels
    description: Synchronize product stock levels with external systems
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              products:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 1
                    sku:
                      type: string
                      example: "PROD-001"
                    stock:
                      type: integer
                      example: 95
              source:
                type: string
                enum: [magento, mdm, all]
                default: all
    responses:
      '200':
        description: Stock sync completed successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Stock sync completed successfully"
                data:
                  type: object
                  properties:
                    synced:
                      type: integer
                      example: 145
                    failed:
                      type: integer
                      example: 1
                    total:
                      type: integer
                      example: 146
      '400':
        $ref: '#/components/responses/BadRequest'
      '500':
        $ref: '#/components/responses/InternalServerError'

/sync/status:
  get:
    tags:
      - Sync
    summary: Get sync operation status
    description: Check the status of ongoing or recent sync operations
    parameters:
      - in: query
        name: operation
        schema:
          type: string
          enum: [prices, stocks, all]
        description: Filter by operation type
      - in: query
        name: limit
        schema:
          type: integer
          default: 10
        description: Number of recent operations to return
    responses:
      '200':
        description: Sync status retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    current_operations:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "sync-123"
                          type:
                            type: string
                            enum: [prices, stocks]
                            example: "prices"
                          status:
                            type: string
                            enum: [running, completed, failed]
                            example: "running"
                          progress:
                            type: integer
                            example: 75
                          started_at:
                            type: string
                            format: date-time
                    recent_operations:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "sync-122"
                          type:
                            type: string
                            example: "stocks"
                          status:
                            type: string
                            example: "completed"
                          completed_at:
                            type: string
                            format: date-time
                          results:
                            type: object
                            properties:
                              synced:
                                type: integer
                                example: 100
                              failed:
                                type: integer
                                example: 0
      '500':
        $ref: '#/components/responses/InternalServerError'
